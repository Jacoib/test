In [1]:
import pandas as pd
from datetime import datetime

In [2]:
now = datetime.now()
now

Out[2]:
datetime.datetime(2019, 7, 17, 22, 10, 28, 698000)

In [3]:
now.year

Out[3]:
2019

In [4]:
now.day

Out[4]:
17

In [5]:
now.month

Out[5]:
7

In [8]:
delta = datetime(2011, 1, 7) - datetime(2008, 6, 24, 8, 15)
delta

Out[8]:
datetime.timedelta(days=926, seconds=56700)

In [9]:
delta.days

Out[9]:
926

In [10]:
delta.seconds

Out[10]:
56700

In [11]:
from datetime import timedelta

In [12]:
start = datetime(2011, 1, 7)


In [13]:

start - 2 * timedelta(12)
Out[13]:
datetime.datetime(2010, 12, 14, 0, 0)
In [15]:
stamp = datetime(2011, 1, 3)
str(stamp)
Out[15]:
'2011-01-03 00:00:00'
In [16]:
stamp.strftime('%Y-%m-%d')
Out[16]:
'2011-01-03'
In [17]:
value = '2011-01-03'
In [18]:
datetime.strptime(value, '%Y-%m-%d')
Out[18]:
datetime.datetime(2011, 1, 3, 0, 0)
In [19]:
datestrs = ['7/6/2011', '8/6/2011']
In [20]:
[datetime.strptime(x, '%m/%d/%Y') for x in datestrs]
Out[20]:
[datetime.datetime(2011, 7, 6, 0, 0), datetime.datetime(2011, 8, 6, 0, 0)]
In [21]:
from dateutil.parser import parse
In [22]:
parse('2011-01-03')
Out[22]:
datetime.datetime(2011, 1, 3, 0, 0)
In [23]:
parse('Jan 31, 1997 10:45 PM')
Out[23]:
datetime.datetime(1997, 1, 31, 22, 45)
In [24]:
parse('6/12/2011', dayfirst=True)
Out[24]:
datetime.datetime(2011, 12, 6, 0, 0)
In [25]:
datestrs = ['2011-07-06 12:00:00', '2011-08-06 00:00:00']
In [26]:
pd.to_datetime(datestrs)
Out[26]:
DatetimeIndex(['2011-07-06 12:00:00', '2011-08-06 00:00:00'], dtype='datetime64[ns]', freq=None)
In [28]:
idx = pd.to_datetime(datestrs + [None])
idx
Out[28]:
DatetimeIndex(['2011-07-06 12:00:00', '2011-08-06 00:00:00', 'NaT'], dtype='datetime64[ns]', freq=None)
In [29]:
idx[2]
Out[29]:
NaT
In [30]:
pd.isnull(idx)
Out[30]:
array([False, False,  True])
In [31]:
from datetime import datetime
In [32]:
dates = [datetime(2011, 1, 2), datetime(2011, 1, 5),
          datetime(2011, 1, 7), datetime(2011, 1, 8),
          datetime(2011, 1, 10), datetime(2011, 1, 12)]
In [33]:
import numpy as np
ts = pd.Series(np.random.randn(6), index=dates)
In [34]:
ts
Out[34]:
2011-01-02    1.388280
2011-01-05    1.147657
2011-01-07   -2.362882
2011-01-08    1.211480
2011-01-10    0.311513
2011-01-12   -0.443868
dtype: float64
In [35]:
ts.index
Out[35]:
DatetimeIndex(['2011-01-02', '2011-01-05', '2011-01-07', '2011-01-08',
               '2011-01-10', '2011-01-12'],
              dtype='datetime64[ns]', freq=None)
In [36]:
ts + ts[::2]
Out[36]:
2011-01-02    2.776560
2011-01-05         NaN
2011-01-07   -4.725765
2011-01-08         NaN
2011-01-10    0.623026
2011-01-12         NaN
dtype: float64
In [37]:
ts.index.dtype
Out[37]:
dtype('<M8[ns]')
In [38]:
stamp = ts.index[0]
stamp
Out[38]:
Timestamp('2011-01-02 00:00:00')
In [40]:
stamp = ts.index[2]
In [41]:
ts[stamp]
Out[41]:
-2.3628823704016373
In [42]:
ts['1/10/2011']
Out[42]:
0.3115127775232414
In [43]:
ts['20110110']
Out[43]:
0.3115127775232414
In [44]:
longer_ts = pd.Series(np.random.randn(1000),
                      index=pd.date_range('1/1/2000',
                                          periods=1000))
In [45]:
longer_ts
Out[45]:
2000-01-01   -1.224397
2000-01-02    1.730223
2000-01-03    0.076268
2000-01-04    0.325605
2000-01-05   -0.151895
2000-01-06   -2.030915
2000-01-07    0.766521
2000-01-08   -0.786368
2000-01-09    0.041508
2000-01-10   -0.347250
2000-01-11   -1.810063
2000-01-12   -0.071204
2000-01-13    0.548795
2000-01-14    1.291151
2000-01-15   -2.168259
2000-01-16   -1.391995
2000-01-17    0.651412
2000-01-18   -1.587417
2000-01-19    1.193333
2000-01-20   -1.228262
2000-01-21    0.184651
2000-01-22    1.874063
2000-01-23    0.130076
2000-01-24   -0.405601
2000-01-25    0.746917
2000-01-26   -0.841487
2000-01-27    0.365387
2000-01-28   -1.917516
2000-01-29   -1.225344
2000-01-30   -1.106521
                ...   
2002-08-28    0.127407
2002-08-29   -1.099829
2002-08-30    1.056271
2002-08-31   -0.216428
2002-09-01   -0.535315
2002-09-02    0.188517
2002-09-03    0.299028
2002-09-04    1.258875
2002-09-05   -0.176863
2002-09-06    1.024431
2002-09-07    1.350242
2002-09-08   -1.375519
2002-09-09    0.780929
2002-09-10   -1.994681
2002-09-11   -0.024279
2002-09-12   -0.487126
2002-09-13    0.752088
2002-09-14    1.296077
2002-09-15    1.533947
2002-09-16    0.496009
2002-09-17   -0.442784
2002-09-18    2.099741
2002-09-19   -0.976496
2002-09-20    0.139131
2002-09-21   -0.415776
2002-09-22   -0.575778
2002-09-23   -0.543248
2002-09-24    0.790472
2002-09-25   -1.837947
2002-09-26    0.933137
Freq: D, Length: 1000, dtype: float64
In [46]:
longer_ts['2001']
Out[46]:
2001-01-01    0.949408
2001-01-02   -0.552600
2001-01-03   -0.184000
2001-01-04    0.597872
2001-01-05   -0.889601
2001-01-06    0.127199
2001-01-07    1.197071
2001-01-08   -1.984591
2001-01-09    0.517935
2001-01-10   -1.628426
2001-01-11    2.678788
2001-01-12   -0.682285
2001-01-13    0.378307
2001-01-14   -0.278435
2001-01-15    0.129245
2001-01-16   -1.011254
2001-01-17   -0.425588
2001-01-18    1.005544
2001-01-19    0.514343
2001-01-20   -0.871652
2001-01-21    1.226243
2001-01-22    0.485149
2001-01-23    1.429794
2001-01-24   -3.038722
2001-01-25    0.504908
2001-01-26   -2.272443
2001-01-27    0.186467
2001-01-28   -1.235076
2001-01-29    0.526651
2001-01-30   -0.104971
                ...   
2001-12-02   -0.545474
2001-12-03    1.169564
2001-12-04   -0.171557
2001-12-05    0.454834
2001-12-06   -0.024212
2001-12-07    1.089809
2001-12-08   -1.203449
2001-12-09   -0.742743
2001-12-10   -0.444957
2001-12-11   -0.575763
2001-12-12    1.562632
2001-12-13    0.154839
2001-12-14   -1.432489
2001-12-15    0.367317
2001-12-16    0.040315
2001-12-17   -0.578919
2001-12-18   -0.427238
2001-12-19   -0.842381
2001-12-20   -1.694073
2001-12-21   -0.491793
2001-12-22    0.648701
2001-12-23    1.077067
2001-12-24   -0.550119
2001-12-25   -1.330233
2001-12-26   -0.511317
2001-12-27   -0.768673
2001-12-28   -1.606976
2001-12-29   -0.418621
2001-12-30   -0.197168
2001-12-31   -0.485659
Freq: D, Length: 365, dtype: float64
In [47]:
longer_ts['2001-05']
Out[47]:
2001-05-01    0.895965
2001-05-02    0.559059
2001-05-03    1.793038
2001-05-04   -0.378604
2001-05-05    1.660686
2001-05-06    0.726380
2001-05-07   -0.335282
2001-05-08    0.540518
2001-05-09   -0.614730
2001-05-10   -0.467588
2001-05-11   -0.009854
2001-05-12    1.262191
2001-05-13   -1.329039
2001-05-14   -0.406006
2001-05-15   -1.177571
2001-05-16   -0.102658
2001-05-17   -2.024504
2001-05-18   -1.408573
2001-05-19   -0.841753
2001-05-20   -2.421502
2001-05-21   -0.591581
2001-05-22   -0.248637
2001-05-23   -1.003497
2001-05-24   -0.473450
2001-05-25    0.620132
2001-05-26    0.380431
2001-05-27   -1.122839
2001-05-28    0.348218
2001-05-29    0.196190
2001-05-30   -1.479793
2001-05-31    0.442986
Freq: D, dtype: float64
In [48]:
ts[datetime(2011, 1, 7)]
ts
Out[48]:
2011-01-02    1.388280
2011-01-05    1.147657
2011-01-07   -2.362882
2011-01-08    1.211480
2011-01-10    0.311513
2011-01-12   -0.443868
dtype: float64
In [49]:
ts['1/6/2011':'1/11/2011']
Out[49]:
2011-01-07   -2.362882
2011-01-08    1.211480
2011-01-10    0.311513
dtype: float64
In [50]:
ts.truncate(after='1/9/2011')
Out[50]:
2011-01-02    1.388280
2011-01-05    1.147657
2011-01-07   -2.362882
2011-01-08    1.211480
dtype: float64
In [51]:
dates = pd.date_range('1/1/2000', periods=100, freq='W-WED')
In [52]:
long_df = pd.DataFrame(np.random.randn(100, 4),
                       index=dates,
                       columns=['Colorado', 'Texas',
         'New York', 'Ohio'])
In [53]:
long_df.loc['5-2001']
Out[53]:
Colorado	Texas	New York	Ohio
2001-05-02	0.864804	0.448756	-0.178241	0.610774
2001-05-09	-0.126389	-0.616137	0.717611	-0.105510
2001-05-16	0.106476	-0.870231	0.049805	0.180957
2001-05-23	-0.647081	0.783890	-0.211372	-0.209772
2001-05-30	-1.364703	-1.339943	0.971650	-0.428091
In [54]:
dates = pd.DatetimeIndex(['1/1/2000', '1/2/2000',
                         '1/2/2000', '1/2/2000', '1/3/2000'])
In [55]:
dup_ts = pd.Series(np.arange(5), index=dates)
In [56]:
dup_ts
Out[56]:
2000-01-01    0
2000-01-02    1
2000-01-02    2
2000-01-02    3
2000-01-03    4
dtype: int32
In [57]:
dup_ts.index.is_unique
Out[57]:
False
In [58]:
dup_ts['1/3/2000']
Out[58]:
4
In [59]:
dup_ts['1/2/2000']
Out[59]:
2000-01-02    1
2000-01-02    2
2000-01-02    3
dtype: int32
In [60]:
grouped = dup_ts.groupby(level=0)
grouped.mean()
Out[60]:
2000-01-01    0
2000-01-02    2
2000-01-03    4
dtype: int32
In [61]:
grouped.count()
Out[61]:
2000-01-01    1
2000-01-02    3
2000-01-03    1
dtype: int64
In [62]:
ts
Out[62]:
2011-01-02    1.388280
2011-01-05    1.147657
2011-01-07   -2.362882
2011-01-08    1.211480
2011-01-10    0.311513
2011-01-12   -0.443868
dtype: float64
In [63]:
resampler = ts.resample('D')
In [64]:
index = pd.date_range('2012-04-01', '2012-06-01')
index
Out[64]:
DatetimeIndex(['2012-04-01', '2012-04-02', '2012-04-03', '2012-04-04',
               '2012-04-05', '2012-04-06', '2012-04-07', '2012-04-08',
               '2012-04-09', '2012-04-10', '2012-04-11', '2012-04-12',
               '2012-04-13', '2012-04-14', '2012-04-15', '2012-04-16',
               '2012-04-17', '2012-04-18', '2012-04-19', '2012-04-20',
               '2012-04-21', '2012-04-22', '2012-04-23', '2012-04-24',
               '2012-04-25', '2012-04-26', '2012-04-27', '2012-04-28',
               '2012-04-29', '2012-04-30', '2012-05-01', '2012-05-02',
               '2012-05-03', '2012-05-04', '2012-05-05', '2012-05-06',
               '2012-05-07', '2012-05-08', '2012-05-09', '2012-05-10',
               '2012-05-11', '2012-05-12', '2012-05-13', '2012-05-14',
               '2012-05-15', '2012-05-16', '2012-05-17', '2012-05-18',
               '2012-05-19', '2012-05-20', '2012-05-21', '2012-05-22',
               '2012-05-23', '2012-05-24', '2012-05-25', '2012-05-26',
               '2012-05-27', '2012-05-28', '2012-05-29', '2012-05-30',
               '2012-05-31', '2012-06-01'],
              dtype='datetime64[ns]', freq='D')
In [65]:
pd.date_range(start='2012-04-01', periods=20)
Out[65]:
DatetimeIndex(['2012-04-01', '2012-04-02', '2012-04-03', '2012-04-04',
               '2012-04-05', '2012-04-06', '2012-04-07', '2012-04-08',
               '2012-04-09', '2012-04-10', '2012-04-11', '2012-04-12',
               '2012-04-13', '2012-04-14', '2012-04-15', '2012-04-16',
               '2012-04-17', '2012-04-18', '2012-04-19', '2012-04-20'],
              dtype='datetime64[ns]', freq='D')
In [66]:
pd.date_range(end='2012-06-01', periods=20)
Out[66]:
DatetimeIndex(['2012-05-13', '2012-05-14', '2012-05-15', '2012-05-16',
               '2012-05-17', '2012-05-18', '2012-05-19', '2012-05-20',
               '2012-05-21', '2012-05-22', '2012-05-23', '2012-05-24',
               '2012-05-25', '2012-05-26', '2012-05-27', '2012-05-28',
               '2012-05-29', '2012-05-30', '2012-05-31', '2012-06-01'],
              dtype='datetime64[ns]', freq='D')
In [67]:
pd.date_range('2000-01-01', '2001-1-01', freq='BM')
Out[67]:
DatetimeIndex(['2000-01-31', '2000-02-29', '2000-03-31', '2000-04-28',
               '2000-05-31', '2000-06-30', '2000-07-31', '2000-08-31',
               '2000-09-29', '2000-10-31', '2000-11-30', '2000-12-29'],
              dtype='datetime64[ns]', freq='BM')
In [68]:
pd.date_range('2012-05-02 12:56:31', periods=5)
Out[68]:
DatetimeIndex(['2012-05-02 12:56:31', '2012-05-03 12:56:31',
               '2012-05-04 12:56:31', '2012-05-05 12:56:31',
               '2012-05-06 12:56:31'],
              dtype='datetime64[ns]', freq='D')
In [69]:
pd.date_range('2012-05-02 12:56:31', periods=5, normalize=True)
Out[69]:
DatetimeIndex(['2012-05-02', '2012-05-03', '2012-05-04', '2012-05-05',
               '2012-05-06'],
              dtype='datetime64[ns]', freq='D')
In [70]:
from pandas.tseries.offsets import Hour, Minute
In [71]:
hour = Hour()
hour
Out[71]:
<Hour>
In [72]:
four_hours = Hour(4)
four_hours
Out[72]:
<4 * Hours>
In [73]:
pd.date_range('2000-01-01', '2000-01-03 23:59', freq='4h')
Out[73]:
DatetimeIndex(['2000-01-01 00:00:00', '2000-01-01 04:00:00',
               '2000-01-01 08:00:00', '2000-01-01 12:00:00',
               '2000-01-01 16:00:00', '2000-01-01 20:00:00',
               '2000-01-02 00:00:00', '2000-01-02 04:00:00',
               '2000-01-02 08:00:00', '2000-01-02 12:00:00',
               '2000-01-02 16:00:00', '2000-01-02 20:00:00',
               '2000-01-03 00:00:00', '2000-01-03 04:00:00',
               '2000-01-03 08:00:00', '2000-01-03 12:00:00',
               '2000-01-03 16:00:00', '2000-01-03 20:00:00'],
              dtype='datetime64[ns]', freq='4H')
In [74]:
Hour(2) + Minute(30)
Out[74]:
<150 * Minutes>
In [75]:
pd.date_range('2000-01-01', periods=10, freq='1h30min')
Out[75]:
DatetimeIndex(['2000-01-01 00:00:00', '2000-01-01 01:30:00',
               '2000-01-01 03:00:00', '2000-01-01 04:30:00',
               '2000-01-01 06:00:00', '2000-01-01 07:30:00',
               '2000-01-01 09:00:00', '2000-01-01 10:30:00',
               '2000-01-01 12:00:00', '2000-01-01 13:30:00'],
              dtype='datetime64[ns]', freq='90T')
In [76]:
rng = pd.date_range('2012-01-01', '2012-09-01', freq='WOM-3FRI')
list(rng)
Out[76]:
[Timestamp('2012-01-20 00:00:00', freq='WOM-3FRI'),
 Timestamp('2012-02-17 00:00:00', freq='WOM-3FRI'),
 Timestamp('2012-03-16 00:00:00', freq='WOM-3FRI'),
 Timestamp('2012-04-20 00:00:00', freq='WOM-3FRI'),
 Timestamp('2012-05-18 00:00:00', freq='WOM-3FRI'),
 Timestamp('2012-06-15 00:00:00', freq='WOM-3FRI'),
 Timestamp('2012-07-20 00:00:00', freq='WOM-3FRI'),
 Timestamp('2012-08-17 00:00:00', freq='WOM-3FRI')]
In [77]:
ts = pd.Series(np.random.randn(4),
               index=pd.date_range('1/1/2000', periods=4,freq='M'))
ts
Out[77]:
2000-01-31   -1.030110
2000-02-29    0.837729
2000-03-31    0.365635
2000-04-30   -1.584213
Freq: M, dtype: float64
In [78]:
ts.shift(2)
Out[78]:
2000-01-31         NaN
2000-02-29         NaN
2000-03-31   -1.030110
2000-04-30    0.837729
Freq: M, dtype: float64
